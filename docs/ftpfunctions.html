<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<meta name="GENERATOR" content="PasDoc 0.11.0">
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<title>ftpfunctions</title>
<link rel="StyleSheet" type="text/css" href="pasdoc.css">
</head>
<body bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#800080" alink="#FF0000">
<h1 class="unit">Unit ftpfunctions</h1>
<table class="sections wide_list">
<tr>
<td><a class="section"  href="#%40Description">Description</a></td><td>uses</td><td>Classes, Interfaces, Objects and Records</td><td><a class="section"  href="#%40FuncsProcs">Functions and Procedures</a></td><td>Types</td><td>Constants</td><td>Variables</td></tr></table>
<a name="%40Description"></a><h2 class="description">Description</h2>
<p>
This unit contain commun functions of FTP</p>
<a name="%40Uses"></a><h2 class="overview">Overview</h2>
<a name="%40FuncsProcs"></a><h3 class="summary">Functions and Procedures</h3>
<table class="summary wide_list">
<tr class="list">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#TryIntParse">TryIntParse</a></b>(const asIntegerString : String; var aiInteger : Integer) : Boolean ;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#AddTrailing">AddTrailing</a></b>(const asString : String; const asChar : String) : String ;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#ConvertMessage">ConvertMessage</a></b>(const asString : String; const asSeparator : String; const asHeader : String; const asEndOfLine : String) : String ;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#StringToTStringList">StringToTStringList</a></b>(const asString : String; const asSeparator : String) : TStringList ;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="ftpfunctions.html#StringToTStringListNoCreate">StringToTStringListNoCreate</a></b>(const asString : String; const asSeparator : String; const aoList : TStrings) ;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#ConvertPassivePort">ConvertPassivePort</a></b>(const asPassivePortString : String; var aiStartPort : Integer; var aiEndPort : Integer) : Boolean ;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#CheckIpAddressInList">CheckIpAddressInList</a></b>(const asIpAddress : String; const aoList : TStringList) : Boolean ;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#CheckTStringsWithJocker">CheckTStringsWithJocker</a></b>(const aoList1 : TStringList; const aoList2 : TStringList) : Boolean ;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="ftpfunctions.html#SendString">SendString</a></b>(const aoClientSock : TTCPBlockSocket; const asString : String) ;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#EscapeChar">EscapeChar</a></b>(const asString : String; const asEscapeChar : String; const asCharToEscape : String) : String ;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#ConvertFtpPathToSysPath">ConvertFtpPathToSysPath</a></b>(const asRootPath : String; const asFtpCurrentPath : String; const asFtpPath : String; const abUtf8 : Boolean) : String ;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#StrPos">StrPos</a></b>(const asNeedle : String; const asStringToCheck : String; const abUtf8 : Boolean; const abCaseSensitive : Boolean) : Integer ;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#CheckDirectoryExists">CheckDirectoryExists</a></b>(const asDirectoryName : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#GetAbsoluteFtpPath">GetAbsoluteFtpPath</a></b>(const asFtpPath : String) : String ;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#IsRootInPath">IsRootInPath</a></b>(asRoot : String; asPath : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#MD5">MD5</a></b>(const asString : String) : String ;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#TranslateToPassivePort">TranslateToPassivePort</a></b>(const asIpAddress : String; const aiPort : Integer) : String ;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#CheckFileExists">CheckFileExists</a></b>(const asFileName : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#GetIoResultString">GetIoResultString</a></b>(const aiIoResult : word) : String ;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="ftpfunctions.html#OpenTextFileForRead">OpenTextFileForRead</a></b>(const asFileName : String; var asFile : TextFile);</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="ftpfunctions.html#OpenTextFileForWrite">OpenTextFileForWrite</a></b>(const asFileName : String; var asFile : TextFile);</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#GetFileAttribut">GetFileAttribut</a></b>(const asFileName : String; const abUtf8 : Boolean) : Longint ;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="ftpfunctions.html#OpenTextFileForAppend">OpenTextFileForAppend</a></b>(const asFileName : String; var asFile : TextFile);</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#InternalRenameFile">InternalRenameFile</a></b>(const asOldName : String; const asNewName : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#InternalDeleteFile">InternalDeleteFile</a></b>(const asFileName : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#InternalMakeDirectory">InternalMakeDirectory</a></b>(const asFileName : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="ftpfunctions.html#InternalRemoveDirectory">InternalRemoveDirectory</a></b>(const asFileName : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
</table>
<h2 class="description">Description</h2>
<h3 class="detail">Functions and Procedures</h3>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TryIntParse"></a><code>function <b>TryIntParse</b>(const asIntegerString : String; var aiInteger : Integer) : Boolean ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Try parse a integer value

<p> 

<p></p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asIntegerString</dt>
<dd>String to be converted</dd>
<dt>aiInteger</dt>
<dd>result</dd>
</dl>
<h6 class="description_section">Returns</h6>
<p class="return">true if ok, false else</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="AddTrailing"></a><code>function <b>AddTrailing</b>(const asString : String; const asChar : String) : String ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Add a char at end if no yet

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asString</dt>
<dd>string</dd>
<dt>char</dt>
<dd>to add</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ConvertMessage"></a><code>function <b>ConvertMessage</b>(const asString : String; const asSeparator : String; const asHeader : String; const asEndOfLine : String) : String ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Convert string with \n into xxx

<p>   </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asString</dt>
<dd>string to be converted</dd>
<dt>asSeparator</dt>
<dd>\n or something else</dd>
<dt>asHeader</dt>
<dd>start line</dd>
<dt>asEndOfLine</dt>
<dd>end of line</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="StringToTStringList"></a><code>function <b>StringToTStringList</b>(const asString : String; const asSeparator : String) : TStringList ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Split String to TStringList

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asString</dt>
<dd>string to split</dd>
<dt>asSeparator</dt>
<dd>separator to split</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="StringToTStringListNoCreate"></a><code>procedure <b>StringToTStringListNoCreate</b>(const asString : String; const asSeparator : String; const aoList : TStrings) ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Split String to TStringList

<p>  </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asString</dt>
<dd>string to split</dd>
<dt>asSeparator</dt>
<dd>separator to split</dd>
<dt>aoList</dt>
<dd>list to store result</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ConvertPassivePort"></a><code>function <b>ConvertPassivePort</b>(const asPassivePortString : String; var aiStartPort : Integer; var aiEndPort : Integer) : Boolean ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Split string with '-' separator and convert both part in integer

<p>  

<p></p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asPassivePortString</dt>
<dd>string to be split</dd>
<dt>aiStartPort</dt>
<dd>result of start port</dd>
<dt>aiEndPort</dt>
<dd>result of end port</dd>
</dl>
<h6 class="description_section">Returns</h6>
<p class="return">True if not error</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="CheckIpAddressInList"></a><code>function <b>CheckIpAddressInList</b>(const asIpAddress : String; const aoList : TStringList) : Boolean ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Check an ip address in list of ip address

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asIpAddress</dt>
<dd>ip address to check</dd>
<dt>aoList</dt>
<dd>list of ip address</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="CheckTStringsWithJocker"></a><code>function <b>CheckTStringsWithJocker</b>(const aoList1 : TStringList; const aoList2 : TStringList) : Boolean ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Check if two list are equals with jocker support

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>aoList1</dt>
<dd>first list</dd>
<dt>aoList2</dt>
<dd>second list</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="SendString"></a><code>procedure <b>SendString</b>(const aoClientSock : TTCPBlockSocket; const asString : String) ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Send a string and add #10#13 at end

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>aoClientSock</dt>
<dd>socket to send</dd>
<dt>asString</dt>
<dd>string to send</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EscapeChar"></a><code>function <b>EscapeChar</b>(const asString : String; const asEscapeChar : String; const asCharToEscape : String) : String ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Escape a char

<p>  </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asString</dt>
<dd>string to read</dd>
<dt>asEscapeChar</dt>
<dd>escape char</dd>
<dt>asCharToEscape</dt>
<dd>char to escape</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ConvertFtpPathToSysPath"></a><code>function <b>ConvertFtpPathToSysPath</b>(const asRootPath : String; const asFtpCurrentPath : String; const asFtpPath : String; const abUtf8 : Boolean) : String ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Convert a FTP path to OS path

<p>   </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asRootPath</dt>
<dd>sys user root. Must and by DirectorySeparator</dd>
<dt>asFtpCurrentPath</dt>
<dd>current ftp path</dd>
<dt>asFtpPath</dt>
<dd>ftp path</dd>
<dt>abUtf8</dt>
<dd>true if use Utf8 file name</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="StrPos"></a><code>function <b>StrPos</b>(const asNeedle : String; const asStringToCheck : String; const abUtf8 : Boolean; const abCaseSensitive : Boolean) : Integer ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Recherche un chaine dans une autre

<p>   </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asNeedle</dt>
<dd>seach string</dd>
<dt>asStringToCheck</dt>
<dd>string to check</dd>
<dt>abUtf8</dt>
<dd>true if utf8</dd>
<dt>asCaseSensitive</dt>
<dd>if seach in case sensitive</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="CheckDirectoryExists"></a><code>function <b>CheckDirectoryExists</b>(const asDirectoryName : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Check if directory exists

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asDirectoryName</dt>
<dd>directory to find</dd>
<dt>abUtf8</dt>
<dd>True if check in utf8</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="GetAbsoluteFtpPath"></a><code>function <b>GetAbsoluteFtpPath</b>(const asFtpPath : String) : String ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Get absolute path for ftp path

<p>@asFtpPath FTP path (/truc/gmachi/../)</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="IsRootInPath"></a><code>function <b>IsRootInPath</b>(asRoot : String; asPath : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Check if root in path

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asRoot</dt>
<dd>root of path</dd>
<dt>asPath</dt>
<dd>path to check</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="MD5"></a><code>function <b>MD5</b>(const asString : String) : String ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Get humain readable md5

<p></p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asString</dt>
<dd>string to parse</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TranslateToPassivePort"></a><code>function <b>TranslateToPassivePort</b>(const asIpAddress : String; const aiPort : Integer) : String ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Translate to passive port

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asIpAddress</dt>
<dd>ip address '127.0.0.1'</dd>
<dt>aiPort</dt>
<dd>port number</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="CheckFileExists"></a><code>function <b>CheckFileExists</b>(const asFileName : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Check if file exists

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asFileName</dt>
<dd>directory to find</dd>
<dt>abUtf8</dt>
<dd>True if check in utf8</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="GetIoResultString"></a><code>function <b>GetIoResultString</b>(const aiIoResult : word) : String ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Return string of IOResult <a  target="_parent" href="http://www.freepascal.org/docs-html/rtl/system/ioresult.html">http://www.freepascal.org/docs-html/rtl/system/ioresult.html</a>

<p>

<p></p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>aiIoResult</dt>
<dd>IOResult</dd>
</dl>
<h6 class="description_section">Returns</h6>
<p class="return">string</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="OpenTextFileForRead"></a><code>procedure <b>OpenTextFileForRead</b>(const asFileName : String; var asFile : TextFile);</code></td>
</tr>
<tr><td colspan="1">
<p>
Open text file in read

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asFileName</dt>
<dd>file name</dd>
<dt>asFile</dt>
<dd>var file</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="OpenTextFileForWrite"></a><code>procedure <b>OpenTextFileForWrite</b>(const asFileName : String; var asFile : TextFile);</code></td>
</tr>
<tr><td colspan="1">
<p>
Open text file in write

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asFileName</dt>
<dd>file name</dd>
<dt>asFile</dt>
<dd>var file</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="GetFileAttribut"></a><code>function <b>GetFileAttribut</b>(const asFileName : String; const abUtf8 : Boolean) : Longint ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Return file attributs

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asFileName</dt>
<dd>file name</dd>
<dt>abUtf8</dt>
<dd>if utf8 mode is used</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="OpenTextFileForAppend"></a><code>procedure <b>OpenTextFileForAppend</b>(const asFileName : String; var asFile : TextFile);</code></td>
</tr>
<tr><td colspan="1">
<p>
Open text file in write

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asFileName</dt>
<dd>file name</dd>
<dt>asFile</dt>
<dd>var file</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="InternalRenameFile"></a><code>function <b>InternalRenameFile</b>(const asOldName : String; const asNewName : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Rename file/directory

<p>  

<p></p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asOldName</dt>
<dd>old name of file</dd>
<dt>asNewName</dt>
<dd>new name of file</dd>
<dt>abUtf8</dt>
<dd>true if utf8 mode enable</dd>
</dl>
<h6 class="description_section">Returns</h6>
<p class="return">true if ok</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="InternalDeleteFile"></a><code>function <b>InternalDeleteFile</b>(const asFileName : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Delete file

<p> 

<p></p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asFileName</dt>
<dd>file name of file</dd>
<dt>abUtf8</dt>
<dd>true if utf8 mode enable</dd>
</dl>
<h6 class="description_section">Returns</h6>
<p class="return">true if ok</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="InternalMakeDirectory"></a><code>function <b>InternalMakeDirectory</b>(const asFileName : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Make directory

<p> 

<p></p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asFileName</dt>
<dd>file name of file</dd>
<dt>abUtf8</dt>
<dd>true if utf8 mode enable</dd>
</dl>
<h6 class="description_section">Returns</h6>
<p class="return">true if ok</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="InternalRemoveDirectory"></a><code>function <b>InternalRemoveDirectory</b>(const asFileName : String; const abUtf8 : Boolean) : Boolean ;</code></td>
</tr>
<tr><td colspan="1">
<p>
Remove directory

<p> 

<p></p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>asFileName</dt>
<dd>file name of file</dd>
<dt>abUtf8</dt>
<dd>true if utf8 mode enable</dd>
</dl>
<h6 class="description_section">Returns</h6>
<p class="return">true if ok</p></td></tr>
</table>
<hr noshade size="1"><span class="appinfo"><em>Generated by <a  target="_parent" href="http://pasdoc.sourceforge.net/">PasDoc 0.11.0</a> on 2010-03-12 08:26:19</em>
</span>
</body></html>
